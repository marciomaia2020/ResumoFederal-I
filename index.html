<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Loteria Federal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0065b3',
                        'primary-light': '#1976d2',
                        'primary-dark': '#004c8c',
                        secondary: '#f9fbfa',
                        'secondary-light': '#ffffff',
                        'secondary-dark': '#e5f0f6',
                        'light-bg': '#f9fbfa',
                        'dark-bg': '#001a2e',
                        'custom-100': '#ffffff',
                        'custom-95': '#f9fbfa',
                        'custom-90': '#f3f7fa',
                        'custom-85': '#edf3f9',
                        'custom-80': '#e7eff8',
                        'custom-75': '#e1ebf7',
                        'custom-70': '#dbe7f6',
                        'custom-65': '#d5e3f5',
                        'custom-60': '#cfdef4',
                        'custom-55': '#c9daf3',
                        'custom-50': '#c3d6f2',
                        'custom-45': '#b7cef0',
                        'custom-40': '#abc6ee',
                        'custom-35': '#9fbeec',
                        'custom-30': '#93b6ea',
                        'custom-29': '#0065b3',
                        'custom-25': '#004c8c',
                        'custom-20': '#003d70',
                        'custom-15': '#002e54',
                        'custom-10': '#001a2e',
                        'custom-5': '#000d17',
                        'custom-0': '#000000'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
        .loading-circle {
            width: 100px;
            height: 100px;
            background-image: linear-gradient(45deg, #0065b3, #1976d2, #f9fbfa);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }
        
        .numero-federal {
            background: linear-gradient(135deg, #e5f0f6, #f9fbfa);
            color: #0065b3;
            border: 2px solid #0065b3;
            border-radius: 12px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            padding: 8px 12px;
            font-size: 16px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 101, 179, 0.1);
            min-width: 80px;
        }
        
        .dark .numero-federal {
            background: linear-gradient(135deg, #004c8c, #001a2e);
            color: #e5f0f6;
            border-color: #1976d2;
        }
        
        .posicao-badge {
            background: linear-gradient(45deg, #0065b3, #1976d2);
            color: white;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
        }
        
        .serie-badge {
            background: linear-gradient(45deg, #f9fbfa, #e5f0f6);
            color: #0065b3;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            border: 1px solid #0065b3;
        }

        .numero-palpite-federal {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            color: white;
            border: 2px solid #2563eb;
            border-radius: 12px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            padding: 8px 12px;
            font-size: 14px;
            text-align: center;
            min-width: 80px;
        }

        .dark .numero-palpite-federal {
            background: linear-gradient(135deg, #1e3a8a, #1d4ed8);
            color: #dbeafe;
            border-color: #1d4ed8;
        }

        .input-numero-federal {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
            text-align: center;
            font-weight: bold;
            border: 2px solid #0065b3;
            border-radius: 8px;
        }

        .input-numero-federal:focus {
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(0, 101, 179, 0.1);
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                üé´ Resultados Loteria Federal - ORDEM DE SORTEIO
            </h1>
            <p class="text-gray-600 dark:text-gray-300">
                Resultados oficiais da Caixa Econ√¥mica Federal - DO PRIMEIRO AO √öLTIMO CONCURSO
            </p>
        </div>

        <!-- Controles -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col gap-4">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <label class="text-gray-700 dark:text-gray-300 font-medium">
                            Concursos:
                        </label>
                        <input 
                            type="number" 
                            id="concursoInicio" 
                            value="1"
                            placeholder="Concurso inicial"
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                        <span class="text-gray-500 dark:text-gray-400">at√©</span>
                        <input 
                            type="number" 
                            id="concursoFim" 
                            placeholder="Buscando √∫ltimo..."
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                    </div>
                    <button 
                        id="buscarBtn" 
                        class="bg-primary hover:bg-primary-dark text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50"
                    >
                        üîç Carregar TODOS os Resultados
                    </button>
                </div>
                
                <!-- Op√ß√µes de ordena√ß√£o -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <label class="text-gray-700 dark:text-gray-300 font-medium">
                        Op√ß√µes:
                    </label>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarConcursoDecrescente" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">üî¢ Concursos em ordem decrescente</span>
                    </label>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="mostrarDetalhes" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">üè™ Mostrar lot√©ricas</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-600 dark:text-gray-300 mb-4">
                Carregando TODOS os resultados do primeiro ao √∫ltimo concurso...
            </p>
            
            <!-- Barra de progresso -->
            <div class="max-w-md mx-auto">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2">
                    <div id="progressBar" class="bg-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span id="progressText">0 / 0 concursos</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <!-- Bot√£o cancelar -->
            <button id="cancelarBtn" class="mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors">
                ‚ùå Cancelar Carregamento
            </button>
        </div>

        <!-- Erro -->
        <div id="erro" class="hidden bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg mb-6">
            <span id="erroMsg"></span>
        </div>

        <!-- Bot√£o Toggle Tabela -->
        <div id="toggleTabelaContainer" class="hidden mb-4 text-center">
            <button 
                id="toggleTabelaBtn" 
                class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200"
            >
                üëÅÔ∏è Ocultar Tabela de Resultados
            </button>
        </div>

        <!-- Tabela de Resultados -->
        <div id="resultados" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                <div class="text-white p-4" style="background: linear-gradient(to right, #0065b3, #1976d2);">
                    <h2 class="text-xl font-bold text-center">LOTERIA FEDERAL - TODOS OS CONCURSOS</h2>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Concurso
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Data Sorteio
                                </th>
                                <!-- 5 colunas para os n√∫meros federais -->
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">1¬∫ Pr√™mio</span>
                                        <input type="text" id="filtro1" placeholder="Filtro" class="mt-1 px-2 py-1 text-xs border rounded w-16">
                                    </div>
                                </th>
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">2¬∫ Pr√™mio</span>
                                        <input type="text" id="filtro2" placeholder="Filtro" class="mt-1 px-2 py-1 text-xs border rounded w-16">
                                    </div>
                                </th>
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">3¬∫ Pr√™mio</span>
                                        <input type="text" id="filtro3" placeholder="Filtro" class="mt-1 px-2 py-1 text-xs border rounded w-16">
                                    </div>
                                </th>
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">4¬∫ Pr√™mio</span>
                                        <input type="text" id="filtro4" placeholder="Filtro" class="mt-1 px-2 py-1 text-xs border rounded w-16">
                                    </div>
                                </th>
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">5¬∫ Pr√™mio</span>
                                        <input type="text" id="filtro5" placeholder="Filtro" class="mt-1 px-2 py-1 text-xs border rounded w-16">
                                    </div>
                                </th>
                                <th id="colunaDetalhes" class="px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Lot√©ricas
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Resultados ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3">
                    <div class="flex flex-col sm:flex-row justify-between items-center">
                        <p class="text-sm text-gray-600 dark:text-gray-300">
                            üìä Fonte: Caixa Econ√¥mica Federal - API Oficial
                        </p>
                        <p id="contadorResultados" class="text-sm font-medium text-primary-dark dark:text-primary-light">
                            <!-- Contador ser√° inserido aqui -->
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resumo Estat√≠stico -->
        <div id="resumoEstatistico" class="hidden mt-8 rounded-lg p-6" style="background: linear-gradient(to right, #f9fbfa, #f3f7fa); border: 1px solid #c9daf3;">
            <h3 class="text-xl font-bold mb-6 text-center" style="color: #004c8c;">
                üìä Resumo Estat√≠stico da Federal
            </h3>
            <div id="estatisticasGerais" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Estat√≠sticas ser√£o inseridas aqui -->
            </div>
            
            <!-- An√°lise de N√∫meros -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ An√°lise de N√∫meros Federais
                </h4>
                <div id="analiseNumeros" class="space-y-3">
                    <!-- An√°lise ser√° inserida aqui -->
                </div>
            </div>
            
            <!-- Estat√≠sticas por Posi√ß√£o -->
            <div id="estatisticasPosicao" class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Estat√≠sticas por Posi√ß√£o de Pr√™mio
                </h4>
                <div id="dadosPosicoes" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- Dados por posi√ß√£o ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- An√°lise de Termina√ß√µes -->
            <div class="mt-6 p-4 rounded-lg" style="background: linear-gradient(to bottom right, #f3f7fa, #e7eff8); border: 1px solid #c9daf3;">
                <h4 class="text-lg font-semibold mb-3 text-center" style="color: #004c8c;">
                    üìä An√°lise de Termina√ß√µes
                </h4>
                
                <!-- Controle de jogos a analisar -->
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-4">
                    <label class="text-sm font-medium" style="color: #003d70;">
                        Analisar √∫ltimos:
                    </label>
                    <input 
                        type="number" 
                        id="jogosAnalisar" 
                        value="50"
                        min="1"
                        max="200"
                        placeholder="N¬∫ de jogos"
                        class="px-3 py-2 text-base border rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white w-24"
                        style="border-color: #c9daf3; --tw-ring-color: #0065b3;"
                    >
                    <span class="text-sm" style="color: #003d70;">concursos mais recentes</span>
                    <button 
                        id="atualizarAnalise" 
                        class="text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm"
                        style="background-color: #0065b3;"
                        onmouseover="this.style.backgroundColor='#004c8c'"
                        onmouseout="this.style.backgroundColor='#0065b3'"
                    >
                        üîÑ Atualizar
                    </button>
                </div>
                
                <!-- An√°lise de termina√ß√µes -->
                <div id="analiseTerminacoes" class="mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- An√°lise ser√° inserida aqui -->
                </div>
            </div>

            <!-- Estat√≠sticas de Lot√©ricas -->
            <div id="estatisticasLotericas" class="mt-6 p-4 rounded-lg" style="background: linear-gradient(45deg, #e5f0f6, #f9fbfa); color: #0065b3;">
                <h4 class="text-lg font-semibold mb-3 text-center" style="color: #004c8c;">
                    üè™ Estat√≠sticas das Lot√©ricas Contempladas
                </h4>
                <div id="dadosLotericas" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Dados das lot√©ricas ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- Padr√µes encontrados -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üîç Padr√µes Identificados
                </h4>
                <div id="padroes" class="text-sm text-gray-700 dark:text-gray-300">
                    <!-- Padr√µes ser√£o inseridos aqui -->
                </div>
            </div>
        </div>

        <!-- Gerador de Palpites -->
        <div id="geradorPalpites" class="hidden mt-8 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900 dark:to-cyan-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-blue-800 dark:text-blue-200 mb-2">
                    üé´ Gerador de Palpites Federal
                </h3>
                <p class="text-blue-600 dark:text-blue-300 text-sm">
                    Estrat√©gias baseadas em an√°lise de termina√ß√µes e padr√µes dos n√∫meros federais
                </p>
                <button 
                    id="comoFuncionaBtn" 
                    class="mt-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors"
                >
                    ‚ùì Como Funciona?
                </button>
            </div>

            <!-- Informa√ß√µes do √öltimo Concurso -->
            <div id="infoConcursoAtual" class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üìä √öltimo Concurso Dispon√≠vel
                </h4>
                <div id="dadosUltimoConcurso" class="text-center">
                    <!-- Dados do √∫ltimo concurso ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- Estrat√©gias de Palpite -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- Estrat√©gia 1: An√°lise de Termina√ß√µes -->
                <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-blue-800 dark:text-blue-200 mb-3 text-center">
                        üéØ Estrat√©gia 1: An√°lise de Termina√ß√µes
                    </h4>
                    <p class="text-sm text-blue-700 dark:text-blue-300 mb-4 text-center">
                        Baseia-se nos √∫ltimos 2 d√≠gitos mais frequentes por posi√ß√£o
                    </p>
                    
                    <!-- Controles -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-blue-700 dark:text-blue-300 block mb-2">
                            Analisar √∫ltimos:
                        </label>
                        <input 
                            type="number" 
                            id="concursosAnalise1" 
                            value="30"
                            min="1"
                            max="100"
                            class="px-3 py-1 text-base border border-blue-300 dark:border-blue-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        />
                        <span class="text-xs text-blue-600 dark:text-blue-400 block mt-1">concursos</span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia1" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üéØ Gerar Palpite
                        </button>
                    </div>
                    <div id="resultadoEstrategia1" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 1 -->
                    </div>
                </div>

                <!-- Estrat√©gia 2: Padr√µes por Posi√ß√£o -->
                <div class="bg-cyan-50 dark:bg-cyan-900 border border-cyan-200 dark:border-cyan-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-cyan-800 dark:text-cyan-200 mb-3 text-center">
                        üìà Estrat√©gia 2: Padr√µes por Posi√ß√£o
                    </h4>
                    <p class="text-sm text-cyan-700 dark:text-cyan-300 mb-4 text-center">
                        Analisa os n√∫meros mais frequentes em cada posi√ß√£o
                    </p>
                    <div class="text-center space-y-2">
                        <div class="mb-4 text-center">
                            <label class="text-sm font-medium text-cyan-700 dark:text-cyan-300 block mb-2">
                                Analisar √∫ltimos:
                            </label>
                            <input 
                                type="number" 
                                id="concursosAnalise2" 
                                value="40"
                                min="1"
                                max="100"
                                class="px-3 py-1 text-base border border-cyan-300 dark:border-cyan-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                            />
                            <span class="text-xs text-cyan-600 dark:text-cyan-400 block mt-1">concursos</span>
                        </div>
                        
                        <button 
                            id="gerarEstrategia2" 
                            class="bg-cyan-500 hover:bg-cyan-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üìà Gerar Palpite
                        </button>
                    </div>
                    <div id="resultadoEstrategia2" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 2 -->
                    </div>
                </div>

                <!-- Estrat√©gia 3: Sequ√™ncias Num√©ricas -->
                <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-200 mb-3 text-center">
                        üî¢ Estrat√©gia 3: Sequ√™ncias Num√©ricas
                    </h4>
                    <p class="text-sm text-green-700 dark:text-green-300 mb-4 text-center">
                        Busca padr√µes em sequ√™ncias e progress√µes
                    </p>
                    
                    <!-- Controles -->
                    <div class="mb-4 text-center space-y-2">
                        <label class="text-sm font-medium text-green-700 dark:text-green-300 block">
                            Analisar √∫ltimos:
                        </label>
                        <input 
                            type="number" 
                            id="concursosAnalise3" 
                            value="25"
                            min="1"
                            max="100"
                            class="px-3 py-1 text-base border border-green-300 dark:border-green-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        >
                        <span class="text-xs text-green-600 dark:text-green-400 block">concursos</span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia3" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üî¢ Gerar Palpite
                        </button>
                    </div>
                    <div id="resultadoEstrategia3" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 3 -->
                    </div>
                </div>
            </div>

            <!-- Gerador Manual de Palpites -->
            <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">
                    ‚úã Palpite Manual - Monte seus pr√≥prios n√∫meros
                </h4>
                
                <div id="palpiteManual" class="space-y-4">
                    <!-- 5 n√∫meros federais ser√£o gerados dinamicamente -->
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                        <div class="text-center">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                1¬∫ Pr√™mio
                            </label>
                            <input 
                                type="text" 
                                id="numeroManual1" 
                                maxlength="6" 
                                placeholder="000000"
                                class="input-numero-federal px-3 py-2 text-base dark:bg-gray-700 dark:text-white w-full"
                            >
                        </div>
                        <div class="text-center">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                2¬∫ Pr√™mio
                            </label>
                            <input 
                                type="text" 
                                id="numeroManual2" 
                                maxlength="6" 
                                placeholder="000000"
                                class="input-numero-federal px-3 py-2 text-base dark:bg-gray-700 dark:text-white w-full"
                            >
                        </div>
                        <div class="text-center">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                3¬∫ Pr√™mio
                            </label>
                            <input 
                                type="text" 
                                id="numeroManual3" 
                                maxlength="6" 
                                placeholder="000000"
                                class="input-numero-federal px-3 py-2 text-base dark:bg-gray-700 dark:text-white w-full"
                            >
                        </div>
                        <div class="text-center">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                4¬∫ Pr√™mio
                            </label>
                            <input 
                                type="text" 
                                id="numeroManual4" 
                                maxlength="6" 
                                placeholder="000000"
                                class="input-numero-federal px-3 py-2 text-base dark:bg-gray-700 dark:text-white w-full"
                            >
                        </div>
                        <div class="text-center">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                5¬∫ Pr√™mio
                            </label>
                            <input 
                                type="text" 
                                id="numeroManual5" 
                                maxlength="6" 
                                placeholder="000000"
                                class="input-numero-federal px-3 py-2 text-base dark:bg-gray-700 dark:text-white w-full"
                            >
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-6 space-x-4">
                    <button 
                        id="limparPalpiteManual" 
                        class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg transition-colors"
                    >
                        üóëÔ∏è Limpar Tudo
                    </button>
                    <button 
                        id="randomizarPalpiteManual" 
                        class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded-lg transition-colors"
                    >
                        üé≤ Randomizar
                    </button>
                    <button 
                        id="salvarPalpiteManual" 
                        class="bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded-lg transition-colors"
                    >
                        üíæ Salvar Palpite
                    </button>
                </div>
            </div>

            <!-- Hist√≥rico de Palpites -->
            <div id="historicoPalpites" class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4">
                <h4 class="text-lg font-semibold text-yellow-800 dark:text-yellow-200 mb-4 text-center">
                    üìã Hist√≥rico de Palpites Gerados
                </h4>
                <div id="listaPalpites" class="space-y-2">
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                </div>
                <div class="text-center mt-4">
                    <button 
                        id="limparHistorico" 
                        class="bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-2 px-4 rounded-lg transition-colors"
                    >
                        üóëÔ∏è Limpar Hist√≥rico
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Popup "Como Funciona" -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="text-white p-6 rounded-t-lg" style="background: linear-gradient(to right, #0065b3, #1976d2);">
                    <h2 class="text-2xl font-bold text-center">
                        üé´ Como Funciona o Gerador de Palpites - Federal
                    </h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- Estrat√©gia 1 -->
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-3">
                            üéØ Estrat√©gia 1: An√°lise de Termina√ß√µes
                        </h3>
                        <div class="space-y-3 text-blue-700 dark:text-blue-300">
                            <p><strong>Conceito:</strong> Analisa os √∫ltimos 2 d√≠gitos mais frequentes por posi√ß√£o.</p>
                            <p><strong>L√≥gica:</strong> Certas termina√ß√µes aparecem com maior frequ√™ncia em cada posi√ß√£o.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-blue-500">
                                <p class="font-medium mb-2">Exemplo pr√°tico:</p>
                                <p>‚Ä¢ <span class="font-bold">1¬∫ Pr√™mio:</span> Termina√ß√µes **25, **47, **83 s√£o mais frequentes</p>
                                <p>‚Ä¢ <span class="font-bold">2¬∫ Pr√™mio:</span> Termina√ß√µes **12, **56, **78 s√£o mais frequentes</p>
                                <p>‚Ä¢ <span class="font-bold">Estrat√©gia:</span> Gera n√∫meros com termina√ß√µes mais prov√°veis</p>
                                <p>‚Ä¢ <span class="font-bold">Resultado:</span> 5 n√∫meros com padr√µes de termina√ß√£o otimizados</p>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 2 -->
                    <div class="bg-cyan-50 dark:bg-cyan-900 border border-cyan-200 dark:border-cyan-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-cyan-800 dark:text-cyan-200 mb-3">
                            üìà Estrat√©gia 2: Padr√µes por Posi√ß√£o
                        </h3>
                        <div class="space-y-3 text-cyan-700 dark:text-cyan-300">
                            <p><strong>Conceito:</strong> Considera os n√∫meros mais frequentes em cada posi√ß√£o espec√≠fica.</p>
                            <p><strong>L√≥gica:</strong> Cada posi√ß√£o tem n√∫meros que aparecem com maior frequ√™ncia.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-cyan-500">
                                <p class="font-medium mb-2">Fluxo de an√°lise:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-cyan-600">1. Separa√ß√£o:</span> Analisa cada posi√ß√£o independentemente</p>
                                    <p>‚Ä¢ <span class="font-bold text-blue-600">2. Frequ√™ncia:</span> Calcula n√∫meros mais sorteados por posi√ß√£o</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">3. Padr√µes:</span> Identifica faixas num√©ricas mais comuns</p>
                                    <p>‚Ä¢ <span class="font-bold text-purple-600">4. Gera√ß√£o:</span> Cria n√∫meros baseados nos padr√µes identificados</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 3 -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-3">
                            üî¢ Estrat√©gia 3: Sequ√™ncias Num√©ricas
                        </h3>
                        <div class="space-y-3 text-green-700 dark:text-green-300">
                            <p><strong>Conceito:</strong> Busca padr√µes em sequ√™ncias e progress√µes num√©ricas.</p>
                            <p><strong>L√≥gica:</strong> N√∫meros pr√≥ximos ou em sequ√™ncia podem ter tend√™ncias.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-green-500">
                                <p class="font-medium mb-2">An√°lise de sequ√™ncias:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold">Progress√µes:</span> Identifica n√∫meros em sequ√™ncia crescente/decrescente</p>
                                    <p>‚Ä¢ <span class="font-bold">Proximidade:</span> N√∫meros pr√≥ximos que saem juntos</p>
                                    <p>‚Ä¢ <span class="font-bold">Espa√ßamento:</span> Intervalos comuns entre n√∫meros</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Aplica√ß√£o:</span> Gera n√∫meros seguindo padr√µes sequenciais</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Palpite Manual -->
                    <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-3">
                            ‚úã Palpite Manual
                        </h3>
                        <div class="space-y-3 text-purple-700 dark:text-purple-300">
                            <p><strong>Conceito:</strong> Digite seus pr√≥prios n√∫meros de 6 d√≠gitos para cada posi√ß√£o.</p>
                            <p><strong>Funcionalidades:</strong> Inser√ß√£o manual + ferramentas auxiliares.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-purple-500">
                                <p class="font-medium mb-2">Recursos dispon√≠veis:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-blue-600">Entrada Manual:</span> Digite n√∫meros de 000000 a 999999</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Randomizar:</span> Gera 5 n√∫meros aleat√≥rios automaticamente</p>
                                    <p>‚Ä¢ <span class="font-bold text-orange-600">Limpar:</span> Remove todos os n√∫meros inseridos</p>
                                    <p>‚Ä¢ <span class="font-bold text-purple-600">Salvar:</span> Adiciona ao hist√≥rico de palpites</p>
                                    <p>‚Ä¢ <span class="font-bold text-red-600">Valida√ß√£o:</span> Verifica formato correto (6 d√≠gitos)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estat√≠sticas -->
                    <div class="rounded-lg p-4" style="background: linear-gradient(to right, #f9fbfa, #f3f7fa); border: 1px solid #c9daf3;">
                        <h3 class="text-xl font-bold mb-3" style="color: #004c8c;">
                            üìä Base Estat√≠stica Federal
                        </h3>
                        <div class="space-y-2" style="color: #003d70;">
                            <p>‚Ä¢ <strong>N√∫meros por concurso:</strong> 5 n√∫meros de 6 d√≠gitos</p>
                            <p>‚Ä¢ <strong>Faixa num√©rica:</strong> 000000 a 999999 (1 milh√£o de possibilidades)</p>
                            <p>‚Ä¢ <strong>Posi√ß√µes fixas:</strong> 1¬∫, 2¬∫, 3¬∫, 4¬∫ e 5¬∫ pr√™mios</p>
                            <p>‚Ä¢ <strong>Pr√™mios fixos:</strong> Valores pr√©-definidos por posi√ß√£o</p>
                            <p>‚Ä¢ <strong>Termina√ß√µes importantes:</strong> √öltimos 2 d√≠gitos t√™m padr√µes</p>
                            <p>‚Ä¢ <strong>Especial Federal:</strong> √önica loteria com n√∫meros de 6 d√≠gitos</p>
                            <p>‚Ä¢ <strong>Estrat√©gia otimizada:</strong> Foco em termina√ß√µes e padr√µes posicionais</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                    <button 
                        id="fecharModal" 
                        class="text-white font-medium py-2 px-6 rounded-lg transition-colors"
                        style="background: linear-gradient(45deg, #0065b3, #1976d2);"
                    >
                        ‚úÖ Entendi, Vamos Gerar Palpites!
                    </button>
                </div>
            </div>
        </div>

        <!-- Informa√ß√µes Adicionais -->
        <div id="infoAdicional" class="hidden mt-8 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-4">
                üìã Informa√ß√µes do Concurso
            </h3>
            <div id="detalhes" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300">
                <!-- Detalhes ser√£o inseridos aqui -->
            </div>
        </div>
    </div>

    <script>
        // Detectar tema escuro
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Elementos do DOM
        const concursoInicio = document.getElementById('concursoInicio');
        const concursoFim = document.getElementById('concursoFim');
        const buscarBtn = document.getElementById('buscarBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const cancelarBtn = document.getElementById('cancelarBtn');
        const erro = document.getElementById('erro');
        const erroMsg = document.getElementById('erroMsg');
        const resultados = document.getElementById('resultados');
        const tabelaBody = document.getElementById('tabelaBody');
        const infoAdicional = document.getElementById('infoAdicional');
        const detalhes = document.getElementById('detalhes');
        const ordenarConcursoDecrescente = document.getElementById('ordenarConcursoDecrescente');
        const mostrarDetalhes = document.getElementById('mostrarDetalhes');

        // Vari√°veis globais
        let todosResultados = [];
        let carregamentoAtivo = false;
        let ultimoConcursoNumero = 0;

        // Vari√°veis do gerador de palpites
        let ultimoConcursoData = null;
        let historicoPalpitesData = [];

        // Fun√ß√£o para formatar data
        function formatarData(dataStr) {
            if (!dataStr) return 'N/A';
            
            try {
                let data;
                
                if (dataStr instanceof Date) {
                    data = dataStr;
                } else if (typeof dataStr === 'string') {
                    if (dataStr.includes('/')) {
                        const [dia, mes, ano] = dataStr.split('/');
                        data = new Date(ano, mes - 1, dia);
                    } else if (dataStr.includes('-')) {
                        data = new Date(dataStr);
                    } else if (dataStr.length === 8 && !isNaN(dataStr)) {
                        const dia = dataStr.substr(0, 2);
                        const mes = dataStr.substr(2, 2);
                        const ano = dataStr.substr(4, 4);
                        data = new Date(ano, mes - 1, dia);
                    } else if (!isNaN(dataStr)) {
                        data = new Date(parseInt(dataStr));
                    } else {
                        data = new Date(dataStr);
                    }
                } else {
                    data = new Date(dataStr);
                }
                
                if (data && !isNaN(data.getTime())) {
                    return data.toLocaleDateString('pt-BR');
                } else {
                    return 'N/A';
                }
            } catch (error) {
                console.error('Erro ao formatar data:', dataStr, error);
                return 'N/A';
            }
        }

        // Fun√ß√£o para buscar √∫ltimo concurso de forma robusta
        async function buscarUltimoConcurso() {
            console.log('üöÄ Iniciando busca robusta do √∫ltimo concurso da Federal...');
            
            // Estrat√©gia 1: Tentar API principal m√∫ltiplas vezes
            for (let tentativa = 1; tentativa <= 3; tentativa++) {
                try {
                    console.log(`üîç Tentativa ${tentativa}: API principal...`);
                    const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/federal', {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero && data.numero > 0) {
                            console.log(`‚úÖ Sucesso! √öltimo concurso encontrado: ${data.numero}`);
                            return data.numero;
                        }
                    }
                    
                    console.log(`‚ö†Ô∏è Tentativa ${tentativa} falhou: ${response.status}`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                } catch (error) {
                    console.log(`‚ùå Erro na tentativa ${tentativa}:`, error.message);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            // Estrat√©gia 2: Busca sequencial reversa
            console.log('üîÑ Iniciando busca sequencial reversa...');
            
            for (let concurso = 6200; concurso >= 6000; concurso--) {
                try {
                    console.log(`üîç Testando concurso ${concurso}...`);
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/federal/${concurso}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero === concurso && data.dezenasSorteadasOrdemSorteio) {
                            console.log(`üéØ ENCONTRADO! √öltimo concurso v√°lido: ${concurso}`);
                            return concurso;
                        }
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                } catch (error) {
                    continue;
                }
            }
            
            // Estrat√©gia 3: Fallback
            console.log('‚ö†Ô∏è Todas as estrat√©gias falharam, usando fallback...');
            const ultimoConhecido = 6100;
            console.log(`üìå Usando √∫ltimo concurso conhecido: ${ultimoConhecido}`);
            return ultimoConhecido;
        }

        // Fun√ß√£o para atualizar progresso
        function atualizarProgresso(atual, total) {
            const porcentagem = Math.round((atual / total) * 100);
            progressBar.style.width = `${porcentagem}%`;
            progressText.textContent = `${atual} / ${total} concursos`;
            progressPercent.textContent = `${porcentagem}%`;
        }

        // Fun√ß√£o para cancelar carregamento
        function cancelarCarregamento() {
            carregamentoAtivo = false;
            loading.classList.add('hidden');
            buscarBtn.disabled = false;
            loadingText.textContent = 'Carregamento cancelado';
        }

        // FUN√á√ÉO PRINCIPAL: Carregar TODOS os concursos
        async function carregarTodosOsConcursos() {
            console.log('üöÄ INICIANDO: Carregar TODOS os concursos da Federal...');
            
            loading.classList.remove('hidden');
            resultados.classList.add('hidden');
            erro.classList.add('hidden');
            infoAdicional.classList.add('hidden');
            buscarBtn.disabled = true;
            carregamentoAtivo = true;

            try {
                loadingText.textContent = 'üîç Buscando √∫ltimo concurso dispon√≠vel...';
                const ultimoConcurso = await buscarUltimoConcurso();
                
                if (!ultimoConcurso) {
                    throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso');
                }

                ultimoConcursoNumero = ultimoConcurso;
                concursoInicio.value = 1;
                concursoFim.value = ultimoConcurso;
                
                console.log(`‚úÖ Definido: Concurso 1 at√© ${ultimoConcurso}`);

                const totalConcursos = ultimoConcurso;
                const tamanhoBatch = 10;
                let concursosCarregados = 0;

                loadingText.textContent = `üìä Carregando TODOS os ${totalConcursos} concursos em lotes...`;
                atualizarProgresso(0, totalConcursos);

                todosResultados = [];

                for (let i = 1; i <= ultimoConcurso && carregamentoAtivo; i += tamanhoBatch) {
                    const fimBatch = Math.min(i + tamanhoBatch - 1, ultimoConcurso);
                    
                    loadingText.textContent = `üì• Carregando concursos ${i} a ${fimBatch}...`;
                    
                    const promisesBatch = [];
                    for (let j = i; j <= fimBatch; j++) {
                        promisesBatch.push(buscarConcursoComRetry(j));
                    }

                    const resultadosBatch = await Promise.allSettled(promisesBatch);
                    
                    resultadosBatch.forEach((resultado, index) => {
                        if (resultado.status === 'fulfilled' && resultado.value) {
                            todosResultados.push(resultado.value);
                        }
                        concursosCarregados++;
                        atualizarProgresso(concursosCarregados, totalConcursos);
                    });

                    if (todosResultados.length > 0) {
                        todosResultados.sort((a, b) => a.numero - b.numero);
                        exibirTodosResultados();
                    }

                    await new Promise(resolve => setTimeout(resolve, 300));
                }

                if (!carregamentoAtivo) {
                    throw new Error('Carregamento cancelado pelo usu√°rio');
                }

                todosResultados.sort((a, b) => a.numero - b.numero);

                if (todosResultados.length === 0) {
                    throw new Error('Nenhum resultado encontrado na API. Tente novamente.');
                }

                loadingText.textContent = `‚úÖ SUCESSO! Carregados ${todosResultados.length} concursos (do primeiro ao √∫ltimo)`;
                exibirTodosResultados();
                gerarResumoEstatistico();
                inicializarGeradorPalpites();
                
                console.log(`üéâ CONCLU√çDO: ${todosResultados.length} concursos carregados com sucesso!`);
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar todos os concursos:', error);
                erroMsg.textContent = `Erro: ${error.message}`;
                erro.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
                buscarBtn.disabled = false;
                carregamentoAtivo = false;
            }
        }

        // Fun√ß√£o para buscar um concurso com retry
        async function buscarConcursoComRetry(numero, tentativas = 3) {
            for (let i = 0; i < tentativas; i++) {
                try {
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/federal/${numero}`, {
                        timeout: 10000
                    });
                    if (!response.ok) {
                        if (i === tentativas - 1) return null;
                        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                        continue;
                    }
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`Tentativa ${i + 1} falhou para concurso ${numero}:`, error);
                    if (i === tentativas - 1) return null;
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                }
            }
            return null;
        }

        // Fun√ß√£o para criar c√©lula de n√∫mero federal
        function criarCelulaNumeroFederal(numero, posicao) {
            const cellNumero = document.createElement('td');
            cellNumero.className = 'px-2 py-3 whitespace-nowrap text-center';
            
            const divNumero = document.createElement('div');
            divNumero.className = 'numero-federal';
            divNumero.textContent = numero;
            divNumero.dataset.numero = numero;
            divNumero.dataset.posicao = posicao;
            
            cellNumero.appendChild(divNumero);
            return cellNumero;
        }

        // Fun√ß√£o para exibir todos os resultados na tabela
        function exibirTodosResultados() {
            tabelaBody.innerHTML = '';

            // Atualizar visibilidade da coluna de detalhes
            const colunaDetalhes = document.getElementById('colunaDetalhes');
            if (mostrarDetalhes.checked) {
                colunaDetalhes.classList.remove('hidden');
            } else {
                colunaDetalhes.classList.add('hidden');
            }

            const resultadosParaExibir = [...todosResultados].sort((a, b) => {
                if (ordenarConcursoDecrescente.checked) {
                    return b.numero - a.numero;
                } else {
                    return a.numero - b.numero;
                }
            });

            resultadosParaExibir.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                row.dataset.concurso = data.numero;

                // N√∫mero do concurso
                const cellConcurso = document.createElement('td');
                cellConcurso.className = 'px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white';
                cellConcurso.textContent = data.numero;
                row.appendChild(cellConcurso);

                // Data do sorteio
                const cellData = document.createElement('td');
                cellData.className = 'px-3 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300';
                
                const dataFormatada = formatarData(data.dataApuracao) || 
                                    formatarData(data.dataSorteio) || 
                                    formatarData(data.data) || 
                                    'N/A';
                                    
                cellData.textContent = dataFormatada;
                row.appendChild(cellData);

                // N√∫meros federais (5 n√∫meros de 6 d√≠gitos)
                if (data.dezenasSorteadasOrdemSorteio) {
                    data.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        const cellNumero = criarCelulaNumeroFederal(numero, index + 1);
                        cellNumero.dataset.coluna = index + 1;
                        row.appendChild(cellNumero);
                    });
                }

                // Detalhes das lot√©ricas
                if (mostrarDetalhes.checked) {
                    const cellDetalhes = document.createElement('td');
                    cellDetalhes.className = 'px-3 py-3 text-xs';
                    
                    if (data.listaMunicipioUFGanhadores && data.listaMunicipioUFGanhadores.length > 0) {
                        let detalhesHTML = '';
                        data.listaMunicipioUFGanhadores.forEach(ganhador => {
                            detalhesHTML += `
                                <div class="mb-2 p-2 bg-gray-50 dark:bg-gray-700 rounded">
                                    <div class="posicao-badge inline-block mb-1">${ganhador.posicao}¬∫</div>
                                    <div class="serie-badge inline-block mb-1">S√©rie ${ganhador.serie}</div>
                                    <div class="text-xs text-gray-600 dark:text-gray-400">
                                        ${ganhador.nomeFatansiaUL}<br>
                                        ${ganhador.municipio}/${ganhador.uf}
                                    </div>
                                </div>
                            `;
                        });
                        cellDetalhes.innerHTML = detalhesHTML;
                    } else {
                        cellDetalhes.textContent = 'N/A';
                    }
                    
                    row.appendChild(cellDetalhes);
                }

                tabelaBody.appendChild(row);
            });

            resultados.classList.remove('hidden');
            document.getElementById('toggleTabelaContainer').classList.remove('hidden');
            aplicarFiltros();
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const filtros = [];
            for (let i = 1; i <= 5; i++) {
                const filtro = document.getElementById(`filtro${i}`).value.trim();
                filtros.push(filtro);
            }

            const rows = tabelaBody.querySelectorAll('tr');
            let resultadosVisiveis = 0;
            
            rows.forEach(row => {
                let mostrar = true;
                
                filtros.forEach((filtro, index) => {
                    if (filtro) {
                        const celula = row.querySelector(`td[data-coluna="${index + 1}"]`);
                        if (celula) {
                            const numeroElement = celula.querySelector('.numero-federal');
                            if (numeroElement) {
                                const numero = numeroElement.textContent.trim();
                                if (!numero.includes(filtro)) {
                                    mostrar = false;
                                }
                            }
                        }
                    }
                });

                row.style.display = mostrar ? '' : 'none';
                if (mostrar) {
                    resultadosVisiveis++;
                }
            });

            atualizarContador(resultadosVisiveis, todosResultados.length);
        }

        // Fun√ß√£o para atualizar contador de resultados
        function atualizarContador(visiveis, total) {
            const contador = document.getElementById('contadorResultados');
            if (visiveis === total) {
                contador.textContent = `üìä ${total} concursos carregados (COMPLETO)`;
            } else {
                contador.textContent = `üìä ${visiveis} de ${total} concursos (filtrado)`;
            }
        }

        // Event listeners b√°sicos
        buscarBtn.addEventListener('click', carregarTodosOsConcursos);
        cancelarBtn.addEventListener('click', cancelarCarregamento);
        
        for (let i = 1; i <= 5; i++) {
            const filtro = document.getElementById(`filtro${i}`);
            filtro.addEventListener('input', aplicarFiltros);
        }
        
        ordenarConcursoDecrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        mostrarDetalhes.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        concursoInicio.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });
        
        concursoFim.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });

        // Fun√ß√£o para calcular estat√≠sticas da Federal
        function calcularEstatisticasFederal() {
            const estatisticas = {
                terminacoes: {},
                posicoesFrequentes: [[], [], [], [], []],
                totalNumeros: 0,
                numerosMaisFrequentes: {},
                padroes: {}
            };

            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio) {
                    resultado.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        estatisticas.totalNumeros++;
                        
                        const terminacao = numero.slice(-2);
                        estatisticas.terminacoes[terminacao] = (estatisticas.terminacoes[terminacao] || 0) + 1;
                        
                        estatisticas.posicoesFrequentes[index].push(numero);
                        
                        estatisticas.numerosMaisFrequentes[numero] = (estatisticas.numerosMaisFrequentes[numero] || 0) + 1;
                    });
                }
            });

            return estatisticas;
        }

        // Fun√ß√£o para calcular estat√≠sticas de lot√©ricas
        function calcularEstatisticasLotericas() {
            const lotericas = {};
            const municipios = {};
            const estados = {};

            todosResultados.forEach(resultado => {
                if (resultado.listaMunicipioUFGanhadores) {
                    resultado.listaMunicipioUFGanhadores.forEach(ganhador => {
                        const nomeLoter = ganhador.nomeFatansiaUL;
                        if (nomeLoter) {
                            lotericas[nomeLoter] = (lotericas[nomeLoter] || 0) + 1;
                        }
                        
                        const municipio = `${ganhador.municipio}/${ganhador.uf}`;
                        municipios[municipio] = (municipios[municipio] || 0) + 1;
                        
                        estados[ganhador.uf] = (estados[ganhador.uf] || 0) + 1;
                    });
                }
            });

            return {
                lotericas: Object.entries(lotericas).sort(([,a], [,b]) => b - a).slice(0, 10),
                municipios: Object.entries(municipios).sort(([,a], [,b]) => b - a).slice(0, 10),
                estados: Object.entries(estados).sort(([,a], [,b]) => b - a)
            };
        }

        // Fun√ß√£o para gerar resumo estat√≠stico
        function gerarResumoEstatistico() {
            if (todosResultados.length === 0) return;

            const resumoDiv = document.getElementById('resumoEstatistico');
            const estatisticasDiv = document.getElementById('estatisticasGerais');
            const analiseNumerosDiv = document.getElementById('analiseNumeros');
            const dadosPosicoes = document.getElementById('dadosPosicoes');
            const dadosLotericas = document.getElementById('dadosLotericas');
            const padroesDiv = document.getElementById('padroes');

            const stats = calcularEstatisticasFederal();
            const statsLotericas = calcularEstatisticasLotericas();
            const totalConcursos = todosResultados.length;

            // Cards estat√≠sticos principais
            estatisticasDiv.innerHTML = `
                <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600 dark:text-blue-300">${totalConcursos}</div>
                    <div class="text-sm text-blue-800 dark:text-blue-200">Concursos</div>
                    <div class="text-sm font-semibold text-blue-800 dark:text-blue-200">Analisados</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #f3f7fa;">
                    <div class="text-2xl font-bold" style="color: #0065b3;">${stats.totalNumeros}</div>
                    <div class="text-sm" style="color: #004c8c;">N√∫meros</div>
                    <div class="text-sm font-semibold" style="color: #004c8c;">Sorteados</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #edf3f9;">
                    <div class="text-2xl font-bold" style="color: #0065b3;">${Object.keys(stats.terminacoes).length}</div>
                    <div class="text-sm" style="color: #004c8c;">Termina√ß√µes</div>
                    <div class="text-sm font-semibold" style="color: #004c8c;">Diferentes</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #e7eff8;">
                    <div class="text-2xl font-bold" style="color: #0065b3;">${statsLotericas.estados.length}</div>
                    <div class="text-sm" style="color: #004c8c;">Estados</div>
                    <div class="text-sm font-semibold" style="color: #004c8c;">Contemplados</div>
                </div>
            `;

            // An√°lise de n√∫meros mais frequentes
            const numerosMaisFrequentes = Object.entries(stats.numerosMaisFrequentes)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);

            let analiseHTML = '<div class="grid grid-cols-2 md:grid-cols-5 gap-2 mb-4">';
            numerosMaisFrequentes.forEach(([numero, count]) => {
                const perc = ((count / totalConcursos) * 100).toFixed(1);
                analiseHTML += `
                    <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded text-center">
                        <div class="numero-federal text-xs">${numero}</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">${count}x (${perc}%)</div>
                    </div>
                `;
            });
            analiseHTML += '</div>';
            
            analiseNumerosDiv.innerHTML = analiseHTML;

            // Estat√≠sticas por posi√ß√£o
            let posicoesHTML = '';
            for (let pos = 0; pos < 5; pos++) {
                const numerosPos = stats.posicoesFrequentes[pos];
                const contadorPos = {};
                
                numerosPos.forEach(num => {
                    contadorPos[num] = (contadorPos[num] || 0) + 1;
                });
                
                const maisFrequentePos = Object.entries(contadorPos)
                    .sort(([,a], [,b]) => b - a)[0] || ['N/A', 0];
                
                posicoesHTML += `
                    <div class="p-3 rounded-lg border text-center" style="background: linear-gradient(to bottom right, #f9fbfa, #f3f7fa); border-color: #c9daf3;">
                        <h5 class="font-bold mb-2 text-sm" style="color: #004c8c;">üé´ ${pos + 1}¬∫ Pr√™mio</h5>
                        <div class="numero-federal text-xs">${maisFrequentePos[0]}</div>
                        <div class="text-xs mt-1" style="color: #003d70;">Mais frequente</div>
                        <div class="text-xs" style="color: #002e54;">${maisFrequentePos[1]}x</div>
                    </div>
                `;
            }
            dadosPosicoes.innerHTML = posicoesHTML;

            // Estat√≠sticas de lot√©ricas
            let lotericasHTML = `
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold" style="color: #0065b3;">${statsLotericas.lotericas.length}</div>
                    <div class="text-sm" style="color: #004c8c;">Lot√©ricas</div>
                    <div class="text-xs" style="color: #003d70;">Contempladas</div>
                </div>
            `;
            
            statsLotericas.estados.slice(0, 5).forEach(([estado, count]) => {
                const perc = ((count / totalConcursos) * 100).toFixed(1);
                lotericasHTML += `
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg text-center">
                        <div class="text-lg font-bold" style="color: #0065b3;">${estado}</div>
                        <div class="text-sm" style="color: #004c8c;">${count} pr√™mios</div>
                        <div class="text-xs" style="color: #003d70;">${perc}%</div>
                    </div>
                `;
            });
            
            dadosLotericas.innerHTML = lotericasHTML;

            // An√°lise de termina√ß√µes
            gerarAnaliseTerminacoes();

            // Padr√µes e insights
            let insights = '';
            const terminacaoMaisComum = Object.entries(stats.terminacoes)
                .sort(([,a], [,b]) => b - a)[0];
            
            if (terminacaoMaisComum) {
                insights += `<p><strong>üéØ Termina√ß√£o mais comum:</strong> ${terminacaoMaisComum[0]} apareceu ${terminacaoMaisComum[1]} vezes.</p>`;
            }
            
            const estadoMaisContemplado = statsLotericas.estados[0];
            if (estadoMaisContemplado) {
                insights += `<p><strong>üèÜ Estado mais contemplado:</strong> ${estadoMaisContemplado[0]} com ${estadoMaisContemplado[1]} pr√™mios.</p>`;
            }
            
            insights += `<p><strong>üé´ Especial Federal:</strong> A Federal sorteia n√∫meros de 6 d√≠gitos, oferecendo pr√™mios fixos por posi√ß√£o.</p>`;
            
            padroesDiv.innerHTML = insights;

            resumoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para gerar an√°lise de termina√ß√µes
        function gerarAnaliseTerminacoes(jogosAnalisar = 50) {
            const analiseTerminacoesDiv = document.getElementById('analiseTerminacoes');
            
            if (todosResultados.length < jogosAnalisar) {
                analiseTerminacoesDiv.innerHTML = '<p class="text-center text-gray-500">Dados insuficientes para an√°lise</p>';
                return;
            }

            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, jogosAnalisar);

            const terminacoesPorPosicao = [{}, {}, {}, {}, {}];

            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    concurso.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        const terminacao = numero.slice(-2);
                        terminacoesPorPosicao[index][terminacao] = 
                            (terminacoesPorPosicao[index][terminacao] || 0) + 1;
                    });
                }
            });

            let terminacoesHTML = '';
            for (let pos = 0; pos < 5; pos++) {
                const terminacaoMaisFrequente = Object.entries(terminacoesPorPosicao[pos])
                    .sort(([,a], [,b]) => b - a)[0] || ['--', 0];
                
                terminacoesHTML += `
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg text-center border" style="border-color: #c9daf3;">
                        <div class="text-xs font-medium mb-1" style="color: #0065b3;">${pos + 1}¬∫ Pr√™mio</div>
                        <div class="text-lg font-bold" style="color: #004c8c;">**${terminacaoMaisFrequente[0]}</div>
                        <div class="text-xs" style="color: #003d70;">${terminacaoMaisFrequente[1]}x</div>
                    </div>
                `;
            }
            
            analiseTerminacoesDiv.innerHTML = terminacoesHTML;
        }

        // Event listeners para an√°lise
        document.getElementById('atualizarAnalise').addEventListener('click', () => {
            const jogos = parseInt(document.getElementById('jogosAnalisar').value) || 50;
            if (jogos < 1 || jogos > 200) {
                mostrarModal('Erro', 'Por favor, insira um valor entre 1 e 200 jogos.');
                return;
            }
            if (todosResultados.length < jogos) {
                mostrarModal('Dados Insuficientes', `N√£o h√° dados suficientes. Dispon√≠vel: ${todosResultados.length} jogos, Solicitado: ${jogos}`);
                return;
            }
            gerarAnaliseTerminacoes(jogos);
        });

        document.getElementById('jogosAnalisar').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('atualizarAnalise').click();
            }
        });

        // Fun√ß√£o para mostrar modal personalizada
        function mostrarModal(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">${titulo}</h3>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event listener para toggle da tabela
        document.getElementById('toggleTabelaBtn').addEventListener('click', () => {
            const resultados = document.getElementById('resultados');
            const toggleBtn = document.getElementById('toggleTabelaBtn');
            
            if (resultados.classList.contains('hidden')) {
                resultados.classList.remove('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Ocultar Tabela de Resultados';
                toggleBtn.className = 'bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            } else {
                resultados.classList.add('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Mostrar Tabela de Resultados';
                toggleBtn.className = 'bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            }
        });

        // üé´ FUN√á√ïES DO GERADOR DE PALPITES FEDERAL

        // Fun√ß√£o para inicializar o gerador de palpites
        function inicializarGeradorPalpites() {
            if (todosResultados.length === 0) return;

            ultimoConcursoData = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            atualizarInfoUltimoConcurso();
            configurarInputsNumericos();

            document.getElementById('geradorPalpites').classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar informa√ß√µes do √∫ltimo concurso
        function atualizarInfoUltimoConcurso() {
            const dadosDiv = document.getElementById('dadosUltimoConcurso');
            
            if (!ultimoConcursoData) {
                dadosDiv.innerHTML = '<p class="text-gray-500">Nenhum dado dispon√≠vel</p>';
                return;
            }

            const numeros = (ultimoConcursoData.dezenasSorteadasOrdemSorteio || []);

            const numerosHTML = numeros
                .map((numero, index) => `
                    <div class="text-center">
                        <div class="text-xs font-medium text-blue-700 dark:text-blue-300 mb-1">${index + 1}¬∫ Pr√™mio</div>
                        <span class="numero-federal">${numero}</span>
                    </div>
                `).join('');

            const dataFormatada = formatarData(ultimoConcursoData.dataApuracao) || 
                                formatarData(ultimoConcursoData.dataSorteio) || 
                                'N/A';

            dadosDiv.innerHTML = `
                <div class="space-y-4">
                    <div class="text-lg font-semibold text-gray-800 dark:text-gray-200">
                        Concurso: <span class="text-blue-600 dark:text-blue-400">${ultimoConcursoData.numero}</span>
                    </div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Data: ${dataFormatada}
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900 dark:to-cyan-900 p-4 rounded-lg border border-blue-200 dark:border-blue-700">
                        <div class="text-sm font-semibold text-blue-800 dark:text-blue-200 mb-3 text-center">üìä N√∫meros do √öltimo Concurso:</div>
                        <div class="grid grid-cols-5 gap-2">
                            ${numerosHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o para configurar inputs num√©ricos
        function configurarInputsNumericos() {
            for (let i = 1; i <= 5; i++) {
                const input = document.getElementById(`numeroManual${i}`);
                
                input.addEventListener('input', (e) => {
                    // Permitir apenas n√∫meros
                    e.target.value = e.target.value.replace(/[^0-9]/g, '');
                    
                    // Limitar a 6 d√≠gitos
                    if (e.target.value.length > 6) {
                        e.target.value = e.target.value.slice(0, 6);
                    }
                });
                
                input.addEventListener('blur', (e) => {
                    // Preencher com zeros √† esquerda
                    if (e.target.value) {
                        e.target.value = e.target.value.padStart(6, '0');
                    }
                });
            }
        }

        // Fun√ß√£o para gerar n√∫mero federal aleat√≥rio
        function gerarNumeroFederalAleatorio() {
            return Math.floor(Math.random() * 1000000).toString().padStart(6, '0');
        }

        // Fun√ß√£o para gerar estrat√©gia 1: An√°lise de Termina√ß√µes
        function gerarEstrategia1() {
            const concursosAnalise = parseInt(document.getElementById('concursosAnalise1').value) || 30;
            
            if (todosResultados.length < concursosAnalise) {
                mostrarModal('Dados Insuficientes', `Necess√°rio pelo menos ${concursosAnalise} concursos. Dispon√≠vel: ${todosResultados.length}`);
                return;
            }

            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, concursosAnalise);

            // Analisar termina√ß√µes por posi√ß√£o
            const terminacoesPorPosicao = [{}, {}, {}, {}, {}];
            
            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    concurso.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        const terminacao = numero.slice(-2);
                        terminacoesPorPosicao[index][terminacao] = 
                            (terminacoesPorPosicao[index][terminacao] || 0) + 1;
                    });
                }
            });

            // Gerar n√∫meros baseados nas termina√ß√µes mais frequentes
            const palpite = [];
            for (let pos = 0; pos < 5; pos++) {
                const terminacoes = Object.entries(terminacoesPorPosicao[pos])
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5); // Top 5 termina√ß√µes
                
                if (terminacoes.length > 0) {
                    // Escolher uma termina√ß√£o aleatoriamente das mais frequentes
                    const terminacaoEscolhida = terminacoes[Math.floor(Math.random() * Math.min(3, terminacoes.length))][0];
                    
                    // Gerar 4 primeiros d√≠gitos aleat√≥rios + termina√ß√£o
                    const primeiros4 = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
                    const numeroCompleto = primeiros4 + terminacaoEscolhida;
                    
                    palpite.push({
                        posicao: pos + 1,
                        numero: numeroCompleto,
                        terminacao: terminacaoEscolhida
                    });
                } else {
                    // Fallback: n√∫mero completamente aleat√≥rio
                    palpite.push({
                        posicao: pos + 1,
                        numero: gerarNumeroFederalAleatorio(),
                        terminacao: 'aleat√≥ria'
                    });
                }
            }

            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 1,
                palpite: palpite,
                horario: horario,
                info: `An√°lise de Termina√ß√µes (${concursosAnalise} concursos)`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            exibirResultadoEstrategia1(palpite, concursosAnalise);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para gerar estrat√©gia 2: Padr√µes por Posi√ß√£o
        function gerarEstrategia2() {
            const concursosAnalise = parseInt(document.getElementById('concursosAnalise2').value) || 40;
            
            if (todosResultados.length < concursosAnalise) {
                mostrarModal('Dados Insuficientes', `Necess√°rio pelo menos ${concursosAnalise} concursos. Dispon√≠vel: ${todosResultados.length}`);
                return;
            }

            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, concursosAnalise);

            // Analisar faixas num√©ricas por posi√ß√£o
            const faixasPorPosicao = [{}, {}, {}, {}, {}];
            
            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    concurso.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        // Dividir em faixas de 100.000
                        const faixa = Math.floor(parseInt(numero) / 100000);
                        faixasPorPosicao[index][faixa] = (faixasPorPosicao[index][faixa] || 0) + 1;
                    });
                }
            });

            // Gerar n√∫meros baseados nas faixas mais frequentes
            const palpite = [];
            for (let pos = 0; pos < 5; pos++) {
                const faixas = Object.entries(faixasPorPosicao[pos])
                    .sort(([,a], [,b]) => b - a);
                
                if (faixas.length > 0) {
                    // Escolher faixa mais frequente com alguma varia√ß√£o
                    const faixaEscolhida = faixas[Math.floor(Math.random() * Math.min(2, faixas.length))][0];
                    
                    // Gerar n√∫mero dentro da faixa escolhida
                    const minimo = parseInt(faixaEscolhida) * 100000;
                    const maximo = minimo + 99999;
                    const numeroAleatorio = Math.floor(Math.random() * (maximo - minimo + 1)) + minimo;
                    
                    palpite.push({
                        posicao: pos + 1,
                        numero: numeroAleatorio.toString().padStart(6, '0'),
                        faixa: `${minimo.toString().padStart(6, '0')}-${maximo.toString().padStart(6, '0')}`
                    });
                } else {
                    palpite.push({
                        posicao: pos + 1,
                        numero: gerarNumeroFederalAleatorio(),
                        faixa: 'aleat√≥ria'
                    });
                }
            }

            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 2,
                palpite: palpite,
                horario: horario,
                info: `Padr√µes por Posi√ß√£o (${concursosAnalise} concursos)`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            exibirResultadoEstrategia2(palpite, concursosAnalise);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para gerar estrat√©gia 3: Sequ√™ncias Num√©ricas
        function gerarEstrategia3() {
            const concursosAnalise = parseInt(document.getElementById('concursosAnalise3').value) || 25;
            
            if (todosResultados.length < concursosAnalise) {
                mostrarModal('Dados Insuficientes', `Necess√°rio pelo menos ${concursosAnalise} concursos. Dispon√≠vel: ${todosResultados.length}`);
                return;
            }

            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, concursosAnalise);

            // Analisar diferen√ßas entre n√∫meros consecutivos
            const diferencas = [];
            
            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    const numeros = concurso.dezenasSorteadasOrdemSorteio.map(n => parseInt(n));
                    for (let i = 1; i < numeros.length; i++) {
                        const diff = Math.abs(numeros[i] - numeros[i-1]);
                        diferencas.push(diff);
                    }
                }
            });

            // Calcular diferen√ßa m√©dia
            const diferencaMedia = diferencas.reduce((a, b) => a + b, 0) / diferencas.length;

            // Gerar sequ√™ncia baseada em padr√µes
            const palpite = [];
            let numeroBase = Math.floor(Math.random() * 500000) + 100000; // Base aleat√≥ria
            
            for (let pos = 0; pos < 5; pos++) {
                if (pos === 0) {
                    palpite.push({
                        posicao: pos + 1,
                        numero: numeroBase.toString().padStart(6, '0'),
                        padrao: 'base'
                    });
                } else {
                    // Aplicar varia√ß√£o baseada na diferen√ßa m√©dia
                    const variacao = Math.floor((Math.random() - 0.5) * diferencaMedia * 2);
                    numeroBase = Math.max(0, Math.min(999999, numeroBase + variacao));
                    
                    palpite.push({
                        posicao: pos + 1,
                        numero: numeroBase.toString().padStart(6, '0'),
                        padrao: `base ${variacao >= 0 ? '+' : ''}${variacao}`
                    });
                }
            }

            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 3,
                palpite: palpite,
                horario: horario,
                info: `Sequ√™ncias Num√©ricas (${concursosAnalise} concursos)`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            exibirResultadoEstrategia3(palpite, concursosAnalise);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√µes para exibir resultados das estrat√©gias
        function exibirResultadoEstrategia1(palpite, concursos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia1');
            
            const palpiteHTML = palpite.map(item => `
                <div class="text-center">
                    <div class="text-xs font-medium text-blue-700 dark:text-blue-300 mb-1">${item.posicao}¬∫ Pr√™mio</div>
                    <span class="numero-palpite-federal">${item.numero}</span>
                    <div class="text-xs text-blue-600 dark:text-blue-400 mt-1">**${item.terminacao}</div>
                </div>
            `).join('');
            
            resultadoDiv.innerHTML = `
                <div class="bg-blue-100 dark:bg-blue-800 border border-blue-300 dark:border-blue-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-3">
                        ‚úÖ Palpite Gerado (An√°lise de Termina√ß√µes):
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-3 rounded border border-blue-300 dark:border-blue-600">
                        <div class="grid grid-cols-5 gap-2">
                            ${palpiteHTML}
                        </div>
                    </div>
                    
                    <div class="mt-3 text-xs text-blue-600 dark:text-blue-400">
                        Baseado nas termina√ß√µes mais frequentes dos √∫ltimos ${concursos} concursos
                    </div>
                    
                    <!-- Bot√µes de Download -->
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'txt', 1)" 
                                class="bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìÑ TXT
                        </button>
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'html', 1)" 
                                class="bg-orange-500 hover:bg-orange-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üåê HTML
                        </button>
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        function exibirResultadoEstrategia2(palpite, concursos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia2');
            
            const palpiteHTML = palpite.map(item => `
                <div class="text-center">
                    <div class="text-xs font-medium text-cyan-700 dark:text-cyan-300 mb-1">${item.posicao}¬∫ Pr√™mio</div>
                    <span class="numero-palpite-federal" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">${item.numero}</span>
                    <div class="text-xs text-cyan-600 dark:text-cyan-400 mt-1">Faixa otimizada</div>
                </div>
            `).join('');
            
            resultadoDiv.innerHTML = `
                <div class="bg-cyan-100 dark:bg-cyan-800 border border-cyan-300 dark:border-cyan-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-cyan-800 dark:text-cyan-200 mb-3">
                        ‚úÖ Palpite Gerado (Padr√µes por Posi√ß√£o):
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-3 rounded border border-cyan-300 dark:border-cyan-600">
                        <div class="grid grid-cols-5 gap-2">
                            ${palpiteHTML}
                        </div>
                    </div>
                    
                    <div class="mt-3 text-xs text-cyan-600 dark:text-cyan-400">
                        Baseado nas faixas num√©ricas mais frequentes dos √∫ltimos ${concursos} concursos
                    </div>
                    
                    <!-- Bot√µes de Download -->
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'txt', 2)" 
                                class="bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìÑ TXT
                        </button>
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'html', 2)" 
                                class="bg-orange-500 hover:bg-orange-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üåê HTML
                        </button>
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        function exibirResultadoEstrategia3(palpite, concursos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia3');
            
            const palpiteHTML = palpite.map(item => `
                <div class="text-center">
                    <div class="text-xs font-medium text-green-700 dark:text-green-300 mb-1">${item.posicao}¬∫ Pr√™mio</div>
                    <span class="numero-palpite-federal" style="background: linear-gradient(135deg, #10b981, #059669);">${item.numero}</span>
                    <div class="text-xs text-green-600 dark:text-green-400 mt-1">Sequ√™ncia</div>
                </div>
            `).join('');
            
            resultadoDiv.innerHTML = `
                <div class="bg-green-100 dark:bg-green-800 border border-green-300 dark:border-green-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-green-800 dark:text-green-200 mb-3">
                        ‚úÖ Palpite Gerado (Sequ√™ncias Num√©ricas):
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-3 rounded border border-green-300 dark:border-green-600">
                        <div class="grid grid-cols-5 gap-2">
                            ${palpiteHTML}
                        </div>
                    </div>
                    
                    <div class="mt-3 text-xs text-green-600 dark:text-green-400">
                        Baseado em padr√µes sequenciais dos √∫ltimos ${concursos} concursos
                    </div>
                    
                    <!-- Bot√µes de Download -->
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'txt', 3)" 
                                class="bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìÑ TXT
                        </button>
                        <button onclick="baixarPalpiteFederal(${JSON.stringify(palpite).replace(/"/g, '&quot;')}, 'html', 3)" 
                                class="bg-orange-500 hover:bg-orange-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üåê HTML
                        </button>
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√µes do palpite manual
        function limparPalpiteManual() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`numeroManual${i}`).value = '';
            }
        }

        function randomizarPalpiteManual() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`numeroManual${i}`).value = gerarNumeroFederalAleatorio();
            }
        }

        function salvarPalpiteManual() {
            const numeros = [];
            let numerosCompletos = 0;
            
            for (let i = 1; i <= 5; i++) {
                const numero = document.getElementById(`numeroManual${i}`).value.trim();
                if (numero) {
                    if (numero.length !== 6) {
                        mostrarModal('N√∫mero Inv√°lido', `O ${i}¬∫ n√∫mero deve ter exatamente 6 d√≠gitos.`);
                        return;
                    }
                    numeros.push({
                        posicao: i,
                        numero: numero.padStart(6, '0')
                    });
                    numerosCompletos++;
                }
            }
            
            if (numerosCompletos < 5) {
                mostrarModal('Palpite Incompleto', `Voc√™ preencheu apenas ${numerosCompletos} de 5 n√∫meros. Complete todos os n√∫meros antes de salvar.`);
                return;
            }

            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 'manual',
                palpite: numeros,
                horario: horario,
                info: 'Palpite Manual'
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            atualizarHistoricoPalpites();
            
            mostrarModal('Palpite Salvo', 'Seu palpite manual foi salvo no hist√≥rico!');
        }

        // Fun√ß√£o para atualizar hist√≥rico de palpites
        function atualizarHistoricoPalpites() {
            const listaDiv = document.getElementById('listaPalpites');
            
            if (historicoPalpitesData.length === 0) {
                listaDiv.innerHTML = `
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                `;
                return;
            }
            
            const historicoHTML = historicoPalpitesData
                .slice(0, 10)
                .map(palpite => {
                    let estrategiaTexto;
                    switch(palpite.estrategia) {
                        case 1: estrategiaTexto = 'üéØ An√°lise de Termina√ß√µes'; break;
                        case 2: estrategiaTexto = 'üìà Padr√µes por Posi√ß√£o'; break;
                        case 3: estrategiaTexto = 'üî¢ Sequ√™ncias Num√©ricas'; break;
                        case 'manual': estrategiaTexto = '‚úã Palpite Manual'; break;
                        default: estrategiaTexto = '‚ùì Desconhecida';
                    }
                    
                    const numerosHTML = palpite.palpite
                        .map(item => `<span class="numero-federal mx-1 text-xs">${item.numero}</span>`)
                        .join('');
                    
                    return `
                        <div class="bg-white dark:bg-gray-800 border border-yellow-300 dark:border-yellow-600 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-yellow-800 dark:text-yellow-200">
                                    ${estrategiaTexto} - ${palpite.info}
                                </span>
                                <span class="text-xs text-yellow-600 dark:text-yellow-400">
                                    ${palpite.horario}
                                </span>
                            </div>
                            <div class="flex flex-wrap gap-1 justify-center">
                                ${numerosHTML}
                            </div>
                        </div>
                    `;
                })
                .join('');
            
            listaDiv.innerHTML = historicoHTML;
        }

        // Fun√ß√£o para limpar hist√≥rico
        function limparHistorico() {
            historicoPalpitesData = [];
            atualizarHistoricoPalpites();
        }

        // Event listeners do gerador de palpites
        document.getElementById('gerarEstrategia1').addEventListener('click', gerarEstrategia1);
        document.getElementById('gerarEstrategia2').addEventListener('click', gerarEstrategia2);
        document.getElementById('gerarEstrategia3').addEventListener('click', gerarEstrategia3);
        document.getElementById('limparPalpiteManual').addEventListener('click', limparPalpiteManual);
        document.getElementById('randomizarPalpiteManual').addEventListener('click', randomizarPalpiteManual);
        document.getElementById('salvarPalpiteManual').addEventListener('click', salvarPalpiteManual);
        document.getElementById('limparHistorico').addEventListener('click', limparHistorico);

        // Event listeners do modal
        document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.remove('hidden');
        });
        
        document.getElementById('fecharModal').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.add('hidden');
        });
        
        document.getElementById('modalComoFunciona').addEventListener('click', (e) => {
            if (e.target.id === 'modalComoFunciona') {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            }
        });

        // FUN√á√ïES DE DOWNLOAD PARA FEDERAL

        // Fun√ß√£o para gerar conte√∫do TXT (Federal)
        function gerarTXTFederal(palpite) {
            let txt = 'PALPITE FEDERAL - 5 N√öMEROS\n';
            txt += '================================\n\n';
            
            palpite.forEach(item => {
                txt += `${item.posicao}¬∫ Pr√™mio: ${item.numero}\n`;
            });
            
            txt += '\n================================\n';
            txt += 'N√∫meros de 6 d√≠gitos (000000 a 999999)\n';
            txt += `Gerado em: ${new Date().toLocaleString('pt-BR')}\n`;
            
            return txt;
        }

        // Fun√ß√£o para gerar conte√∫do HTML (Federal)
        function gerarHTMLFederal(palpite, estrategia) {
            const estrategiaTexto = estrategia === 1 ? 'An√°lise de Termina√ß√µes' : 
                                  estrategia === 2 ? 'Padr√µes por Posi√ß√£o' : 
                                  estrategia === 3 ? 'Sequ√™ncias Num√©ricas' : 'Estrat√©gia Personalizada';
            const data = new Date().toLocaleDateString('pt-BR');
            const hora = new Date().toLocaleTimeString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palpite Federal - ${estrategiaTexto}</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .cartao { margin: 20px 0; padding: 20px; border: 3px solid #0065b3; border-radius: 12px; background: linear-gradient(to right, #f9fbfa, #f3f7fa); }
        .numeros { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0; }
        .numero { display: flex; flex-direction: column; align-items: center; padding: 15px; border: 2px solid #0065b3; border-radius: 12px; background: white; }
        .numero-federal { background: linear-gradient(135deg, #e5f0f6, #f9fbfa); color: #0065b3; padding: 10px 15px; border-radius: 8px; font-weight: bold; font-family: 'Courier New', monospace; letter-spacing: 2px; font-size: 18px; }
        .info { color: #666; font-size: 14px; text-align: center; margin-top: 20px; }
        .premio { color: #0065b3; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé´ Federal - Palpite Gerado</h1>
        <h2>Estrat√©gia: ${estrategiaTexto}</h2>
        <p>Gerado em: ${data} √†s ${hora}</p>
    </div>
    
    <div class="cartao">
        <h3>N√öMEROS FEDERAIS - 5 PR√äMIOS</h3>
        <div class="numeros">`;

            palpite.forEach(item => {
                html += `
            <div class="numero">
                <div class="premio">${item.posicao}¬∫ Pr√™mio</div>
                <div class="numero-federal">${item.numero}</div>
            </div>`;
            });

            html += `
        </div>
    </div>
    
    <div class="info">
        <p>Total de n√∫meros: 5 (6 d√≠gitos cada)</p>
        <p>Palpite baseado em an√°lise estat√≠stica</p>
        <p>Gerado pela aplica√ß√£o Resultados Federal</p>
    </div>
</body>
</html>`;
            
            return html;
        }

        // Fun√ß√£o principal para baixar palpites (Federal)
        function baixarPalpiteFederal(palpite, formato, estrategia) {
            let conteudo, nomeArquivo, tipoMime;
            
            const timestamp = new Date().toISOString().slice(0,10);
            const estrategiaTexto = estrategia === 1 ? 'terminacoes' : 
                                  estrategia === 2 ? 'posicoes' : 
                                  estrategia === 3 ? 'sequencias' : 'personalizado';
            
            switch(formato) {
                case 'txt':
                    conteudo = gerarTXTFederal(palpite);
                    nomeArquivo = `palpite-federal-${estrategiaTexto}-${timestamp}.txt`;
                    tipoMime = 'text/plain';
                    break;
                
                case 'html':
                    conteudo = gerarHTMLFederal(palpite, estrategia);
                    nomeArquivo = `palpite-federal-${estrategiaTexto}-${timestamp}.html`;
                    tipoMime = 'text/html';
                    break;
                
                default:
                    mostrarModal('Erro', 'Formato n√£o suportado');
                    return;
            }
            
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // üöÄ CARREGAR TODOS OS CONCURSOS AUTOMATICAMENTE AO ABRIR A APP
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ APP INICIADA: Carregando TODOS os concursos da Federal automaticamente...');
            await carregarTodosOsConcursos();
        });
    </script>
</body>
</html>